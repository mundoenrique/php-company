<?php if(!defined('BASEPATH')) exit('No direct script access allowed');
/**
 * @info Modelo para comunicacón con el servicio de cunsultas adicionales
 * @date 2018/08/09
 * @author J. Enrique Peñaloza P.
 * @package models
 */
class additional_inquiries_model extends CI_Model {
	//Atributos de clase
	protected $country;
	protected $token;
	protected $company;
	protected $idProduct;
	protected $userName;
	protected $canal;
	protected $timeLog;
	protected $ip;
	protected $sessionId;
	protected $prefix;
	protected $companyCod;

	public function __construct()
	{
		parent:: __construct();
		$this->country = $this->session->userdata('pais');
		$this->token = $this->session->userdata('token');
		$this->company = $this->session->userdata('acrifS');
		$this->idProduct = $this->session->userdata('idProductoS');
		$this->userName = $this->session->userdata('userName');
		$this->canal = "ceo";
		$this->timeLog = date('m/d/Y H:i');
		$this->ip = $this->input->ip_address();
		$this->sessionId = $this->session->userdata('sessionId');
		$this->prefix = $this->session->userdata('idProductoS');
		$this->companyCod = $this->session->userdata('accodciaS');
		//Agrega lenguajes
		$this->lang->load('dashboard');
		$this->lang->load('users');
		$this->lang->load('consultas');
		$this->lang->load('erroreseol');
	}
	/**
	 * @info Metodo para la conección con el servicio de lotes por facturar
	 * @date 2018/08/09
	 * @author J. Enrique Peñaloza P.
	 */
	public function callWsGetBatchesByInvoice()
	{
		//Construye log de acceso
		$modulo = 'Reportes';
		$function = 'Lotes por Facturar';
		$operation = 'Visualizar Lotes por Facturar';
		$rc = 0;
		$className = 'com.novo.objects.TOs.OrdenServicioTO';

		$logAcceso = np_hoplite_log($this->sessionId, $this->userName, $this->canal, $modulo, $function, $operation, $rc, $this->ip, $this->timeLog);

		$dataRequest = [
			"idOperation" => "lotesPorFacturar",
			"className" => $className,
			"acprefix" => $this->prefix,
			"datosEmpresa" => [
				"acrif" => $this->company
			],
			"logAccesoObject" => $logAcceso,
			"token" => $this->token,
			"pais" => $this->country
		];

		$dataRequest = json_encode($dataRequest, JSON_UNESCAPED_UNICODE);

		log_message('DEBUG', '--[' . $this->userName . '] REQUEST LOTES POR FACTURAR: ' . $dataRequest);

		$encryptionData = np_Hoplite_Encryption($dataRequest);
		$dataRequest = json_encode(["bean" => $encryptionData, "pais" => $this->country]);
		$response = np_Hoplite_GetWS('eolwebInterfaceWS', $dataRequest);
		$jsonResponse = np_Hoplite_Decrypt($response);

		$dataDummy = '{"rc":0,"msg":"Proceso OK","className":"com.novo.objects.MO.ConsolidadoLotesMO","bean":{"listaLotes":[{"TIPOLOTE":false,"lista":[{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"668968","acnumlote":"12011179","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2012-02-29 11:34:18.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":45000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":45000.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"737605","acnumlote":"21031298","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2012-03-21 08:39:36.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":45000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":45000.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"841171","acnumlote":"13010428","nmonto":"","ncantregs":"30","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-01-04 14:28:10.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":45000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":1350000.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"984062","acnumlote":"13060501","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-06-05 16:51:13.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":45000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":45000.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"984065","acnumlote":"13060505","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-06-10 16:55:50.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":45000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":45000.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"984090","acnumlote":"13121030","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-12-10 17:41:18.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":45000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":45000.0,"costoDistrib":0.0,"rc":0}],"nombreEmpresa":"","acdir":"","rif":"","nuevoIva":false,"ctipolote":"1","ncantregs":"35","montoNeto":1575000.0,"montoComision":45000.0,"rc":0},{"TIPOLOTE":false,"lista":[{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2187999","acnumlote":"18071605","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-16 15:45:55.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":150000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":150000.0,"costoDistrib":0.0,"rc":0}],"nombreEmpresa":"","acdir":"","rif":"","nuevoIva":false,"ctipolote":"1","ncantregs":"1","montoNeto":150000.0,"montoComision":150000.0,"rc":0},{"TIPOLOTE":false,"lista":[{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2187994","acnumlote":"0","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-16 15:09:42.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":200000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":200000.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2188005","acnumlote":"18071702","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-17 17:23:55.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":200000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":200000.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2188006","acnumlote":"18071703","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-17 17:36:49.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":200000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":200000.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2188007","acnumlote":"18071704","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-17 17:39:29.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":200000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":200000.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2188008","acnumlote":"18071705","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-17 17:41:27.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":200000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":200000.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2188009","acnumlote":"18071706","nmonto":"","ncantregs":"1","ctipolote":"1","acnombre":"Emisión","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-17 17:43:49.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":200000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":200000.0,"costoDistrib":0.0,"rc":0}],"nombreEmpresa":"","acdir":"","rif":"","nuevoIva":false,"ctipolote":"1","ncantregs":"6","montoNeto":1200000.0,"montoComision":200000.0,"rc":0},{"TIPOLOTE":false,"lista":[{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2188040","acnumlote":"91400051","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-20 10:13:07.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2188042","acnumlote":"91400052","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-20 10:19:07.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0}],"nombreEmpresa":"","acdir":"","rif":"","nuevoIva":false,"ctipolote":"C","ncantregs":"2","montoNeto":0.0,"montoComision":0.0,"rc":0},{"TIPOLOTE":false,"lista":[{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2061234","acnumlote":"91400049","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-02-09 07:10:37.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":3.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":3.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2061235","acnumlote":"91400050","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-02-09 07:24:14.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":3.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":3.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2061236","acnumlote":"91400051","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-02-09 07:33:22.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":3.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":3.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2061238","acnumlote":"91400053","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-02-09 07:47:41.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":3.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":3.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2061239","acnumlote":"91400054","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-02-09 07:55:25.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":3.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":3.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2061240","acnumlote":"91400055","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-02-09 08:04:34.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":3.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":3.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2061241","acnumlote":"91400056","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-02-09 08:08:52.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":3.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":3.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2061242","acnumlote":"91400057","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-02-09 08:12:50.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":3.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":3.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2061243","acnumlote":"91400058","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-02-09 08:18:39.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":3.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":3.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2061245","acnumlote":"91400060","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-02-09 09:54:12.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":3.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":3.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2187992","acnumlote":"91400050","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-12 19:32:01.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":3.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":3.0,"costoDistrib":0.0,"rc":0}],"nombreEmpresa":"","acdir":"","rif":"","nuevoIva":false,"ctipolote":"C","ncantregs":"11","montoNeto":33.0,"montoComision":3.0,"rc":0},{"TIPOLOTE":false,"lista":[{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2061268","acnumlote":"91400048","nmonto":"","ncantregs":"1","ctipolote":"C","acnombre":"Reposición de clave","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-03-02 15:23:31.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":12500.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":12500.0,"costoDistrib":0.0,"rc":0}],"nombreEmpresa":"","acdir":"","rif":"","nuevoIva":false,"ctipolote":"C","ncantregs":"1","montoNeto":12500.0,"montoComision":12500.0,"rc":0},{"TIPOLOTE":false,"lista":[{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"909375","acnumlote":"13010505","nmonto":"","ncantregs":"1","ctipolote":"R","acnombre":"Reposición de tarjeta","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-01-05 13:30:05.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"909429","acnumlote":"13010506","nmonto":"","ncantregs":"1","ctipolote":"R","acnombre":"Reposición de tarjeta","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-01-05 16:58:07.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"909461","acnumlote":"13010507","nmonto":"","ncantregs":"1","ctipolote":"R","acnombre":"Reposición de tarjeta","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-01-05 19:49:35.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"909573","acnumlote":"13010508","nmonto":"","ncantregs":"1","ctipolote":"R","acnombre":"Reposición de tarjeta","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-01-07 08:04:55.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"909610","acnumlote":"13010509","nmonto":"","ncantregs":"1","ctipolote":"R","acnombre":"Reposición de tarjeta","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-01-07 08:58:41.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"910435","acnumlote":"13010706","nmonto":"","ncantregs":"1","ctipolote":"R","acnombre":"Reposición de tarjeta","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-01-07 16:20:15.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"910671","acnumlote":"13010708","nmonto":"","ncantregs":"1","ctipolote":"R","acnombre":"Reposición de tarjeta","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-01-07 21:04:47.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"910697","acnumlote":"13010709","nmonto":"","ncantregs":"1","ctipolote":"R","acnombre":"Reposición de tarjeta","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-01-08 07:39:56.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"910832","acnumlote":"13010710","nmonto":"","ncantregs":"1","ctipolote":"R","acnombre":"Reposición de tarjeta","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2013-01-08 09:57:49.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0},{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2187996","acnumlote":"18041601","nmonto":"","ncantregs":"1","ctipolote":"R","acnombre":"Reposición de tarjeta","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-16 15:37:16.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":0.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":0.0,"costoDistrib":0.0,"rc":0}],"nombreEmpresa":"","acdir":"","rif":"","nuevoIva":false,"ctipolote":"R","ncantregs":"10","montoNeto":0.0,"montoComision":0.0,"rc":0},{"TIPOLOTE":false,"lista":[{"accodcia":"","acrif":"","acnomcia":"","accodgrupo":"","acdir":"","acidlote":"2187993","acnumlote":"0","nmonto":"","ncantregs":"1","ctipolote":"R","acnombre":"Reposición de tarjeta","cestatus":"","status":"PROCESADO","cfacturacion":"","actipoproducto":"","dtfechorvalor":"","accodusuarioc":"","dtfechorcarga":"2018-07-16 13:02:16.0","accodusuarioa":"","dtfechorauto":"","accodusuarioa2":"","dtfechorauto2":"","dtfechorproceso":"","nrechazos":"","nid_trans":"","actipoauto":"","accanal":"","obs":"","acxmlext":"","achist":"","acnocuenta":"","idordens":"","montoComision":45000.0,"montoRecarga":0.0,"montoIVA":0.0,"montoNeto":45000.0,"costoDistrib":0.0,"rc":0}],"nombreEmpresa":"","acdir":"","rif":"","nuevoIva":false,"ctipolote":"R","ncantregs":"1","montoNeto":45000.0,"montoComision":45000.0,"rc":0}]},"logAcceso":{"userName":"MFAJARDO","canal":"ceo","modulo":"Reportes","funcion":"Lotes por Facturar","operacion":"Visualizar Lotes por Facturar","RC":0,"IP":"172.26.4.75","dttimesstamp":"21/11/2012 12:00:00","lenguaje":"es"}}';


		log_message('INFO', '--[' . $this->userName . '] RESPONSE recarga/comision: ' . $jsonResponse);

		$responseServ = json_decode(utf8_encode($jsonResponse));

		$title = lang('SYSTEM_NAME');
		$data = [];
		if(isset($responseServ->rc)) {
			$responseServ = $responseServ->rc != 0 ? json_decode($dataDummy) : $responseServ;
			switch($responseServ->rc) {
				case 0:
					$code = 0;
					$data = (array)$responseServ->bean->listaLotes;
					break;
				case -150:
					$code = 0;
					break;
				case -29:
				case -61:
					$code = 2;
					$msg = lang('ERROR_(-29)');
					break;
				default:
					$code = 1;
					$title = lang('TITULO_LOTES_POR_FACTURAR');
					$msg = lang('ERROR_GET_LIST');

			}
		} else {
			$code = 1;
			$msg = sprintf(lang('ERROR_GENERAL'), 'la lista de lotes por facturar');
		}

		if($code === 2) {
			$this->session->sess_destroy();
			$this->session->unset_userdata($this->session->all_userdata());
		}

		return $response = [
			'code' => $code,
			'title' => $title,
			'msg' => isset($msg) ? $msg : '',
			'data' => isset($data)  ? $data : ''
		];


	}
}
